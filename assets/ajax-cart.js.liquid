function attributeToString(t){return"string"!=typeof t&&"undefined"===(t+="")&&(t=""),jQuery.trim(t)}"undefined"==typeof ShopifyAPI&&(ShopifyAPI={}),ShopifyAPI.onCartUpdate=function(t){},ShopifyAPI.updateCartNote=function(t,a){var e=$(document.body),r={type:"POST",url:"/cart/update.js",data:"note="+attributeToString(t),dataType:"json",beforeSend:function(){e.trigger("beforeUpdateCartNote.ajaxCart",t)},success:function(r){"function"==typeof a?a(r):ShopifyAPI.onCartUpdate(r),e.trigger("afterUpdateCartNote.ajaxCart",[t,r])},error:function(t,a){e.trigger("errorUpdateCartNote.ajaxCart",[t,a]),ShopifyAPI.onError(t,a)},complete:function(t,a){e.trigger("completeUpdateCartNote.ajaxCart",[this,t,a])}};jQuery.ajax(r)},ShopifyAPI.onError=function(XMLHttpRequest,textStatus){var data=eval("("+XMLHttpRequest.responseText+")");data.message&&alert(data.message+"("+data.status+"): "+data.description)},ShopifyAPI.addItemFromForm=function(t,a,e){var r,o=$(document.body),n={type:"POST",url:"/cart/add.js",data:jQuery(t).serialize(),dataType:"json",beforeSend:function(a,e){o.trigger("beforeAddItem.ajaxCart",t)},success:function(e){"function"==typeof a?a(e,t):ShopifyAPI.onItemAdded(e,t),o.trigger("afterAddItem.ajaxCart",[e,t])},error:function(t,a){"function"==typeof e?e(t,a):ShopifyAPI.onError(t,a),o.trigger("errorAddItem.ajaxCart",[t,a])},complete:function(t,a){o.trigger("completeAddItem.ajaxCart",[this,t,a])}},i=new Date,s={type:"POST",url:"/cart/clear.js",dataType:"json",success:function(){ajaxCart.load()},error:function(t,a){console.log("Error"),console.log(a)}};r=localStorage.getItem("lastLoadProduct"),i.setHours(0,0,0,0),(r=null===r?i:new Date(r)).getTime()<i.getTime()?(jQuery.ajax(s),localStorage.removeItem("lastLoadProduct")):(localStorage.setItem("lastLoadProduct",i),jQuery.ajax(n))},ShopifyAPI.getCart=function(t){var a=0;$(document.body).trigger("beforeGetCart.ajaxCart"),jQuery.getJSON("/cart.js",function(e,r){"function"==typeof t?t(e):ShopifyAPI.onCartUpdate(e),$(document.body).trigger("afterGetCart.ajaxCart",e),$(".header-cart-icon").removeClass("cart-items"),e.item_count>0&&(a=e.item_count,$(".header-cart-icon").addClass("cart-items")),$(".cart-count").text(a)})},ShopifyAPI.changeItem=function(t,a,e){var r=$(document.body),o={type:"POST",url:"/cart/change.js",data:"quantity="+a+"&line="+t,dataType:"json",beforeSend:function(){r.trigger("beforeChangeItem.ajaxCart",[t,a])},success:function(o){"function"==typeof e?e(o):ShopifyAPI.onCartUpdate(o),r.trigger("afterChangeItem.ajaxCart",[t,a,o])},error:function(t,a){r.trigger("errorChangeItem.ajaxCart",[t,a]),ShopifyAPI.onError(t,a)},complete:function(t,a){r.trigger("completeChangeItem.ajaxCart",[this,t,a])}};jQuery.ajax(o)};var ajaxCart=function(module,$){"use strict";var init,loadCart,settings,isUpdating,$body,$formContainer,$addToCart,$cartCountSelector,$cartCostSelector,$cartContainer,$drawerContainer,updateCountPrice,formOverride,itemAddedCallback,itemErrorCallback,cartUpdateCallback,buildCart,cartCallback,adjustCart,adjustCartCallback,createQtySelectors,qtySelectors,validateQty;init=function(t){settings={formSelector:'form[action^="/cart/add"]',cartContainer:"#CartContainer",addToCartSelector:'input[type="submit"]',cartCountSelector:null,cartCostSelector:null,moneyFormat:"$",disableAjaxCart:!1,enableQtySelectors:!0},$.extend(settings,t),$formContainer=$(settings.formSelector),$cartContainer=$(settings.cartContainer),$addToCart=$formContainer.find(settings.addToCartSelector),$cartCountSelector=$(settings.cartCountSelector),$cartCostSelector=$(settings.cartCostSelector),$body=$(document.body),isUpdating=!1,settings.enableQtySelectors&&qtySelectors(),!settings.disableAjaxCart&&$addToCart.length&&formOverride(),adjustCart()},loadCart=function(){$body.addClass("drawer--is-loading"),ShopifyAPI.getCart(cartUpdateCallback)},updateCountPrice=function(t){$cartCountSelector&&($cartCountSelector.html(t.item_count).removeClass("hidden-count"),0===t.item_count&&$cartCountSelector.addClass("hidden-count")),$cartCostSelector&&$cartCostSelector.html(Shopify.formatMoney(t.total_price,settings.moneyFormat))},formOverride=function(){$formContainer.on("submit",function(t){t.preventDefault(),$addToCart.removeClass("is-added").addClass("is-adding"),$(".qty-error").remove(),ShopifyAPI.addItemFromForm(t.target,itemAddedCallback,itemErrorCallback)})},itemAddedCallback=function(t){$addToCart.removeClass("is-adding").addClass("is-added"),ShopifyAPI.getCart(cartUpdateCallback)},itemErrorCallback=function(XMLHttpRequest,textStatus){var data=eval("("+XMLHttpRequest.responseText+")");$addToCart.removeClass("is-adding is-added"),data.message&&422==data.status&&$formContainer.after('<div class="errors qty-error">'+data.description+"</div>")},cartUpdateCallback=function(t){updateCountPrice(t),buildCart(t)},buildCart=function(t){if($cartContainer.empty(),0===t.item_count)return $cartContainer.append('<p class="empty-cart-message">Your cart is currently empty.</p>'),void cartCallback(t);var a=[],e={},r={},o=$("#CartTemplate").html(),n=Handlebars.compile(o),i={},s=[],d=[],c=0,l=0,u=[];$.each(t.items,function(t,r){var o=r.properties;if(o&&o.hasOwnProperty("Mealplan")){u.push(r);for(var n in o)"Mealplan"==n&&(i.mealPlanTitle=o[n]),"Plan Weeks"==n&&(i.mealPlanDuration=o[n]),"Plan Image"==n&&(i.mealPlanImage=o[n]);return c+=r.price*r.quantity,l+=r.quantity,i.status=!0,d[r.variant_id]=r.quantity,!0}if(null!==r.image)s=r.image.replace(/(\.[^.]*)$/,"_large$1").replace("http:","");else var s="//cdn.shopify.com/s/assets/admin/no-image-medium-cc9732cb976dd349a0df1d39816fbcc7.gif";e={key:r.key,line:t+1,url:r.url,img:s,name:r.product_title,variation:r.variant_title,properties:r.properties,itemAdd:r.quantity+1,itemMinus:r.quantity-1,itemQty:r.quantity,price:Shopify.formatMoney(r.price,settings.moneyFormat),vendor:r.vendor,linePrice:Shopify.formatMoney(r.line_price,settings.moneyFormat),originalLinePrice:Shopify.formatMoney(r.original_line_price,settings.moneyFormat),discounts:r.discounts,discountsApplied:r.line_price!==r.original_line_price,variantId:r.variant_id},a.push(e)}),i.mealPlanItems=JSON.stringify(u);var p=0,m="You have qualified for free shipping!",f=!1;8900>t.total_price&&(p=8900-t.total_price,m="Spend a further "+Shopify.formatMoney(p,settings.moneyFormat)+" to receive free shipping"),"Yes"!=t.attributes.recycle_box&&"true"!=t.attributes.recycle_box||(f=!0),Object.keys(i).length&&i.hasOwnProperty("status")&&(i.mealPlanDurationNumber=i.mealPlanDuration,i.mealPlanDuration=i.mealPlanDuration+(parseInt(i.mealPlanDuration)>1?" weeks":" week"),i.totalItems=l.toString()+(l>1?" items":" item"),i.totalPrice=Shopify.formatMoney(c,settings.moneyFormat),i.mealPlanDescription="This meal plan will be charged and delivered each week for "+i.mealPlanDuration+". Your first week will be charged immediately.",Object.keys(d).length&&(i.products=Object.assign({},d)),s.push(i)),r={items:a,note:t.note,mealPlan:s,totalPrice:Shopify.formatMoney(t.total_price,settings.moneyFormat),totalCartDiscount:0===t.total_discount?0:"translation missing: en.cart.general.savings_html".replace("[savings]",Shopify.formatMoney(t.total_discount,settings.moneyFormat)),totalCartDiscountApplied:0!==t.total_discount,freeShippingMinimum:Shopify.formatMoney(8900,settings.moneyFormat),totalNeededForFreeShipping:Shopify.formatMoney(p,settings.moneyFormat),freeShippingMessage:m,recycleBoxOption:f},$cartContainer.append(n(r)),cartCallback(t)},cartCallback=function(t){if(window.Shopify&&Shopify.StorefrontExpressButtons&&Shopify.StorefrontExpressButtons.initialize(),document.getElementById("cart_callout_daterange")){var a=" - ";deliveryCalc.startDay.format("M")!==deliveryCalc.endDay.format("M")&&(a=deliveryCalc.startDay.format("MMMM")+" - ");var e=deliveryCalc.startDay.format("ddd Do")+a+deliveryCalc.endDay.format("ddd Do MMMM");document.getElementById("cart_callout_daterange").innerHTML=e}},adjustCart=function(){function t(t,a){isUpdating=!0;var e=$('.ajaxcart__row[data-line="'+t+'"]').addClass("is-loading");0===a&&e.parent().addClass("is-removed"),setTimeout(function(){ShopifyAPI.changeItem(t,a,adjustCartCallback)},250)}$body.on("click",".ajaxcart__qty-adjust",function(){if(!isUpdating){var a=$(this),e=a.data("line"),r=a.siblings(".ajaxcart__qty-num"),o=parseInt(r.val().replace(/\D/g,"")),o=validateQty(o);a.hasClass("ajaxcart__qty--plus")?o+=1:(o-=1)<=0&&(o=0),e?t(e,o):r.val(o)}}),$body.on("change",".ajaxcart__qty-num",function(){if(!isUpdating){var a=$(this),e=a.data("line"),r=parseInt(a.val().replace(/\D/g,"")),r=validateQty(r);e&&t(e,r)}}),$body.on("submit","form.ajaxcart",function(t){isUpdating&&t.preventDefault()}),$body.on("focus",".ajaxcart__qty-adjust",function(){var t=$(this);setTimeout(function(){t.select()},50)}),$body.on("change",'textarea[name="note"]',function(){var t=$(this).val();ShopifyAPI.updateCartNote(t,function(t){})})},adjustCartCallback=function(t){updateCountPrice(t),setTimeout(function(){isUpdating=!1,ShopifyAPI.getCart(buildCart)},150)},createQtySelectors=function(){$('input[type="number"]',$cartContainer).length&&$('input[type="number"]',$cartContainer).each(function(){var t=$(this),a=t.val(),e=a+1,r=a-1,o=a,n=$("#AjaxQty").html(),i=Handlebars.compile(n),s={key:t.data("id"),itemQty:o,itemAdd:e,itemMinus:r};t.after(i(s)).remove()})},qtySelectors=function(){var t=$('input[type="number"]');t.length&&(t.each(function(){var t=$(this),a=t.val(),e=t.attr("name"),r=t.attr("id"),o=a+1,n=a-1,i=a,s=$("#JsQty").html(),d=Handlebars.compile(s),c={key:t.data("id"),itemQty:i,itemAdd:o,itemMinus:n,inputName:e,inputId:r};t.after(d(c)).remove()}),$(".js-qty__adjust").on("click",function(){var t=$(this),a=(t.data("id"),t.siblings(".js-qty__num")),e=parseInt(a.val().replace(/\D/g,"")),e=validateQty(e);t.hasClass("js-qty__adjust--plus")?e+=1:(e-=1)<=1&&(e=1),a.val(e)}))},validateQty=function(t){return(parseFloat(t)!=parseInt(t)||isNaN(t))&&(t=1),t};var tb_init=function(){refreshGrid(),$(".product-grid .product-qty-adjust").on("click",function(){$(this);var t,a,e=$(this),r=$(this).attr("data-productid"),o=$(this).attr("data-variantid"),n=0,i=$('.product-overlay[data-productid="'+r+'"]'),s=$('.product-overlay[data-productid="'+r+'"] .po-spinner'),d=$('.product-overlay[data-productid="'+r+'"] .po-qty');$(i).hasClass("spin"),i.addClass("show-overlay"),s.addClass("show-spinner"),d.removeClass("show-qty"),setTimeout(function(){},4e3),jQuery.getJSON("/cart.js",function(i,s){for(var d=0;d<i.items.length;d++){if(i.items[d].product_id==r){t=!0,a=d+1,n=i.items[d].quantity;break}d==i.items.length-1&&(t=!1)}t?(e.hasClass("product-qty-plus")?n+=1:e.hasClass("product-qty-minus")&&(n-=1),changeItemFromGrid(a,n,r,adjustCartCallback)):e.hasClass("product-qty-plus")&&addItemFromGrid(o,n=1,r,itemAddedCallback)})}),$("body").on("click",".ajaxcart__qty-adjust",function(){setTimeout(function(){refreshGrid()},1500)}),$("body").on("blur",".ajaxcart__qty-num",function(){setTimeout(function(){refreshGrid()},1500)}),$("body").on("click",".clear-cart-btn",function(){$(document.body);var t={type:"POST",url:"/cart/clear.js",dataType:"json",success:function(){ajaxCart.load()},error:function(t,a){console.log("Error"),console.log(a)}};jQuery.ajax(t),setTimeout(function(){refreshGrid()},1500)})},addItemFromGrid=function(t,a,e,r){var o=$(document.body),n={type:"POST",url:"/cart/add.js",data:"quantity="+a+"&id="+t,dataType:"json",success:function(t){"function"==typeof r&&r(),killSpinUpdate(e,a)},error:function(t,a){"function"==typeof errorCallback?errorCallback(t,a):ShopifyAPI.onError(t,a),o.trigger("errorAddItem.ajaxCart",[t,a])},complete:function(t,a){o.trigger("completeAddItem.ajaxCart",[this,t,a])}};jQuery.ajax(n)},changeItemFromGrid=function(t,a,e,r){var o=$(document.body),n={type:"POST",url:"/cart/change.js",data:"quantity="+a+"&line="+t,dataType:"json",beforeSend:function(){o.trigger("beforeChangeItem.ajaxCart",[t,a])},success:function(n){"function"==typeof r?r(n):ShopifyAPI.onCartUpdate(n),o.trigger("afterChangeItem.ajaxCart",[t,a,n]),killSpinUpdate(e,a)},error:function(t,a){o.trigger("errorChangeItem.ajaxCart",[t,a]),ShopifyAPI.onError(t,a)},complete:function(t,a){o.trigger("completeChangeItem.ajaxCart",[this,t,a])}};jQuery.ajax(n)},killSpinUpdate=function(t,a){var e=$('.product-overlay[data-productid="'+t+'"]'),r=$('.product-overlay[data-productid="'+t+'"] .po-spinner'),o=$('.product-overlay[data-productid="'+t+'"] .po-qty'),n=$('.product-qty-minus[data-productid="'+t+'"]');o.html(a),a>0?n.addClass("show-btn"):(n.removeClass("show-btn"),e.removeClass("show-overlay")),setTimeout(function(){r.removeClass("show-spinner"),o.addClass("show-qty")},400)},refreshGrid=function(){$(".product-grid").length&&jQuery.getJSON("/cart.js",function(t,a){"function"==typeof callback&&callback(t),$(".product-grid").each(function(){for(var a=$(this),e=a.attr("data-productid"),r=!1,o=$(a).find(".product-overlay"),n=0;n<t.items.length;n++)if(e==t.items[n].product_id){r=!0;break}r?(a.addClass("inCart"),a.find(".product-qty-minus").addClass("show-btn"),a.find(".po-qty").html(t.items[n].quantity).addClass("show-qty"),o.hasClass("show-overlay")||o.addClass("show-overlay")):(a.removeClass("inCart"),a.find(".product-qty-minus").removeClass("show-btn"),a.find(".po-qty").removeClass("show-qty"),o.hasClass("show-overlay")&&o.removeClass("show-overlay"))})})};return tb_init(),module={init:init,load:loadCart}}(ajaxCart||{},jQuery);